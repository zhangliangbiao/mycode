<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.isz.erp.house.mapper.HouseRoomFeatureMapper">
	<!-- 批量新增 -->
	<insert id="saveHouseRoomFeature" parameterType="java.util.List">
		INSERT INTO `house_room_feature` 
			(`feature_id`,`room_id`, `feature_code`, `create_time`, `create_uid`, `fitment_room_id`)
		VALUES
        <foreach collection="list" item="item" index="index" separator="," >  
     	   (#{item.feature_id},#{item.room_id},#{item.feature_code},#{item.create_time},#{item.create_uid},#{item.fitment_room_id})
   		</foreach>
  	</insert>
	<!-- 根据房间ID返回楼盘房间特色信息  -->
	<select id="selectByRoomId" parameterType="java.lang.String" resultType="com.isz.erp.facade.house.entity.HouseRoomFeature">
		SELECT
			hrf.feature_id,
			hrf.room_id,
			hrf.feature_code,
			hrf.create_time,
			hrf.create_uid,
			hrf.fitment_room_id
		FROM  house_room_feature hrf
		INNER JOIN house_room hr ON hr.room_id=hrf.room_id AND hr.fitment_room_id=hrf.fitment_room_id
		WHERE hrf.room_id=#{room_id}
	</select>
	<!-- 批量删除 -->
	<delete id="deleteByHouseId" parameterType="java.lang.String">
		DELETE hrf FROM house_room_feature hrf 
		INNER JOIN house_room hr ON hr.fitment_room_id=hrf.fitment_room_id
		INNER JOIN house h ON h.house_id=hr.house_id
		WHERE h.house_id=#{house_id}
	</delete>
	<!-- 批量删除 -->
	<delete id="deleteByFitmentId" parameterType="java.lang.String">
		DELETE hrf FROM house_room_feature hrf 
		INNER JOIN fitment_room fr ON fr.fitment_room_id=hrf.fitment_room_id
		INNER JOIN fitment_house fh ON fh.fitment_id=fr.fitment_id
		WHERE fh.fitment_id=#{fitment_id}
	</delete>
	<!-- 批量删除 -->
	<delete id="deleteByHouseIdAndRoomId" parameterType="java.util.Map">
		DELETE hrf FROM house_room_feature hrf 
		INNER JOIN house_room hr ON hr.fitment_room_id=hrf.fitment_room_id
		INNER JOIN house h ON h.house_id=hr.house_id
		WHERE h.house_id=#{house_id} AND hr.room_id=#{room_id}
	</delete>

	<delete id="deleteByRoomIds" parameterType="java.util.Map">
		DELETE FROM house_room_feature WHERE fitment_room_id IN (${roomIds})
	</delete>
</mapper>