<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.isz.erp.house.mapper.ApartmentCountMapper">
<!-- 查询房源状态列表 -->
<select id="searchApartmentCountList" parameterType="java.util.Map" resultType="com.isz.erp.facade.house.entity.ApartmentCount">
	SELECT
		id,
	  entire_rented,
	  entire_booked,
	  entire_warting_rent,
	  entire_fired,
	  entire_burnting,
	  entire_invalid,
	  share_rented,
	  share_booked,
	  share_warting_rent,
	  share_fired,
	  share_burnting,
	  share_invalid,
	  create_time,
	  (IFNULL(entire_rented,0)+IFNULL(entire_booked,0)+ifnull(entire_warting_rent,0)+IFNULL(share_rented,0)+ifnull(share_booked,0)+IFNULL(share_warting_rent,0)) as total
	<include refid="sqlList"></include>
	<if test="null != sort and sort != ''">
		ORDER BY ${sort}
		<if test="null != order and order != ''">
			${order}
		</if>
	</if>
	<if test="null != offset and '' != offset and null != limit and '' != limit" >
		limit offset,limit
	</if>
</select>
<!-- 查询房源状态列表数量 -->
<select id="searchApartmentCountListCount" parameterType="java.util.Map" resultType="java.lang.Integer">
select count(1) <include refid="sqlList"></include>
</select>
<sql id="sqlList">
	FROM
		apartment_count
	<where>
		<trim prefixOverrides="and">
			<if test="null!=create_time_start_search and ''!=create_time_start_search"><![CDATA[and create_time >= CONCAT(#{create_time_start_search}," 00:00:00")]]></if>
			<if test="null!=create_time_end_search and ''!=create_time_end_search"><![CDATA[and create_time <= CONCAT(#{create_time_end_search}," 23:59:59")]]></if>
		</trim>	
	</where>
</sql>
<select id="searchApartmentCountRentedDetail" parameterType="java.util.Map" resultType="com.isz.erp.facade.house.entity.ApartmentCountRented">
select id,custom_inrent,custom_booked,custom_warting_rent,not_renew_but_can_see,not_renew_and_not_see,to_renew,rent_type,create_time from apartment_count_rented 
<where>
		<trim prefixOverrides="and">
			<if test="null != create_time and '' != create_time"><![CDATA[and create_time >= CONCAT(#{create_time}," 00:00:00")]]></if>
			<if test="null != create_time and '' != create_time"><![CDATA[and create_time <= CONCAT(#{create_time}," 23:59:59")]]></if>
			<if test="null != rent_type and '' != rent_type">and rent_type = #{rent_type}</if>
		</trim>
</where>
</select>
</mapper>
